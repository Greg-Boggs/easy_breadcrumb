<?php

/**
 * @file
 * Module's hooks
 */

/**
 * The Easy Breadcrumb module provides a block to be embedded in a page,
 * tipically at some place in near the header.
 * Easy Breadcrumb uses the URL (path alias) and the current page's title to
 * extract the breadcrumb's segments and its respective links.
 * The resulting block will be something like: "Home >> Contact Us" or "Home /
 * Contact us". Such presentation could vary depending on the module's settings.
 *
 * @version 1.0 - 2012-01-05
 */
require_once 'includes/EasyBreadcrumbConstants.inc';

/**
 * Implementation of hook permission
 *
 * @return Assoc
 *   permission items
 * 
 */
function easy_breadcrumb_permission() {
  return array(
    'administer easy_breadcrumb' => array(
      'title' => t('Administer EasyBreadcrumb'),
      'description' => t('Perform administration tasks for the EasyBreadCrumb
        module.'),
    ),
  );
}

/**
 * Implementation of hook menu
 *
 * @return Assoc
 *   menu items
 * 
 */
function easy_breadcrumb_menu() {
  $items = array();
  $items['admin/config/easy-breadcrumb'] = array(
    'title' => 'EasyBreadcrumb form settings',
    'description' => 'Controls settings for the EasyBreadcrumb module',
    'file' => 'easy_breadcrumb_admin.inc',
    'page callback' => 'easy_breadcrumb_settings_page',
    'page arguments' => array(),
    'access arguments' => array('administer easy_breadcrumb'),
  );
  $items['admin/config/easy-breadcrumb/general'] = array(
    'title' => 'EasyBreadcrumb general form settings',
    'description' => 'Controls settings for the EasyBreadcrumb module',
    'file' => 'easy_breadcrumb_admin.inc',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('easy_breadcrumb_general_settings_form'),
    'access arguments' => array('administer easy_breadcrumb'),
    'type' => MENU_DEFAULT_LOCAL_TASK,
    'weight' => 0,
  );
  return $items;
}

/**
 * Implementation of hook theme
 *
 * @return Assoc
 *   theme items
 * 
 */
function easy_breadcrumb_theme($existing, $type, $theme, $path) {
  $path = drupal_get_path('module', 'easy_breadcrumb') . '/tpl';
  return array(
    'easy_breadcrumb' => array(
      'template' => 'easy_breadcrumb',
      'variables' => array(
        'breadcrumb' => NULL,
        'separator' => NULL,
      ),
      'path' => $path,
    ),
  );
}

/**
 * Implementation of hook block_info
 *
 * @return Assoc
 *   the blocks' info
 * 
 */
function easy_breadcrumb_block_info() {
  $block = array();
  $block['easy_breadcrumb'] = array(
    'info' => 'EasyBreadcrumb',
    'cache' => DRUPAL_CACHE_GLOBAL,
  );
  return $block;
}

/**
 * Implementation of hook block_view
 *
 * @param String $delta
 *   the identifier of the required module
 * 
 * @return Assoc
 *   the required block's view
 * 
 */
function easy_breadcrumb_block_view($delta = NULL) {
  $block = array();
  switch ($delta) {
    case 'easy_breadcrumb':
      require_once 'includes/easy_breadcrumb_blocks.inc';
      $block['subject'] = NULL;
      $block['content'] = _easy_breadcrumb_block();
      break;
  }
  return $block;
}
