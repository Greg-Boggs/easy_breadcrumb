<?php/** * Obtains the 'easy_breadcrumb' block * @return Assoc resulting renderizable array */function _easy_breadcrumb_block() {    $default_class = 'easy-breadcrumb_segment';  $class_arr = array($default_class, 'easy-breadcrumb_segment-home');  $home_text = t('Home');  $breadcrumb = array();  $breadcrumb[] = l($home_text, null, array('attributes' => array('class' => $class_arr)));  /** don't waste resources if the current page is the home * */  if (!drupal_is_front_page()) {    $uppercase_mode = variable_get(EasyBreadcrumbConstants::DB_VAR_SEGMENTS_TITLE_MODE, 'ucwords');    $url = drupal_get_path_alias();    $url_arr = explode('/', $url);    $segment_url_arr = array();    $n = count($url_arr);    for ($c = 1, $i = 0; $c < $n; ++$c, ++$i) {      $item = $url_arr[$i];      $segment_url_arr[] = $item;      $segment_url = implode('/', $segment_url_arr);      $segment_title = _easy_breadcrumb_normalize_url_segment_text($item, $uppercase_mode);      $class_arr[1] = 'easy-breadcrumb_segment-' . $c;      $breadcrumb[$c] = l($segment_title, $segment_url, array('attributes' => array('class' => $class_arr)));    }    $title_visible = variable_get(EasyBreadcrumbConstants::DB_VAR_TITLE_VISIBLE, true);    if ($title_visible) {      $class_arr[1] = 'easy-breadcrumb_segment-title';      $title = drupal_get_title();      // if the current page has not title, then extract it from the url      if (!isset($title) || $title === '') {        $title = $url_arr[$n - 1];        $title = _easy_breadcrumb_normalize_url_segment_text($title, $uppercase_mode);      }      $breadcrumb[$n] = l($title, $url, array('attributes' => array('class' => $class_arr)));    }  }  $separator = variable_get(EasyBreadcrumbConstants::DB_VAR_SEGMENTS_SEPARATOR, '>>');  $build = array();  $build['easy_breadcrumb'] = array(      '#theme' => 'easy_breadcrumb',      '#breadcrumb' => $breadcrumb,      '#separator' => $separator  );  return $build;}/** * Normalizes an URL segment's title. e.g., transforms "about-us" into "About Us" or "About us" according menu's settings. * @param string $segment Segment's title to be normalized * @param string $uppercase_mode Specifies the uppercase transformation to be applied to the segment's title, if so. * @return string normalized segment title */function _easy_breadcrumb_normalize_url_segment_text($segment, $uppercase_mode = 'ucwords') {  $segment = str_replace('-', ' ', $segment);  switch ($uppercase_mode) {    case 'ucwords':      $segment = ucwords($segment);      break;    case 'ucfirst':      $segment = ucfirst($segment);      break;    default:  }  return $segment;}